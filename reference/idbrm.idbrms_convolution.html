<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Delay Convolution Model — idbrm.idbrms_convolution • idbrms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Delay Convolution Model — idbrm.idbrms_convolution" />
<meta property="og:description" content="A model that assumes that a secondary observations can be
predicted using a convolution of a primary observation multipled by some
scaling factor. An example use case of this model is to estimate the
case fatality rate (with the primary observation being cases and the
secondary observation being deaths) and then explore factors that influence
it." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



<!-- dependencies from examples -->


  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">idbrms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Delay Convolution Model</h1>
    
    <div class="hidden name"><code>idbrm.idbrms_convolution.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A model that assumes that a secondary observations can be
predicted using a convolution of a primary observation multipled by some
scaling factor. An example use case of this model is to estimate the
case fatality rate (with the primary observation being cases and the
secondary observation being deaths) and then explore factors that influence
it.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for idbrms_convolution</span>
<span class='fu'><a href='brmid.html'>idbrm</a></span><span class='op'>(</span>
  <span class='va'>data</span>,
  formula <span class='op'>=</span> <span class='fu'><a href='id_formula.html'>id_formula</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>,
  family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>negbinomial</a></span><span class='op'>(</span>link <span class='op'>=</span> <span class='st'>"identity"</span><span class='op'>)</span>,
  priors <span class='op'>=</span> <span class='fu'><a href='id_priors.html'>id_priors</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>,
  custom_stancode <span class='op'>=</span> <span class='fu'><a href='id_stancode.html'>id_stancode</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span>,
  dry <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data.frame as produced by <code>prepare</code> that must contain the date,
location (as loc), primary (the data that the outcome is a convolution of)
and secondary (the observation of interest. Should have class
"idbrms_convolution".</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>A formula as defined using <code>id_formula</code> or as supported by
<code><a href='https://rdrr.io/pkg/brms/man/brm.html'>brms::brm</a></code>.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>A observation model family as defined in <code>brms</code>.</p></td>
    </tr>
    <tr>
      <th>priors</th>
      <td><p>A list of priors as defined using <code>brms</code> or <code>id_priors</code>.
Defaults to the the <code>id_priors</code> defined for the model class being fit.</p></td>
    </tr>
    <tr>
      <th>custom_stancode</th>
      <td><p>A list of <code>stanvars</code> used to define custom stancode
in <code>brms</code>. By default uses the code designed for the model class being fit
(as specified using <code>id_stancode</code>).</p></td>
    </tr>
    <tr>
      <th>dry</th>
      <td><p>Logical, defaults to TRUE. For testing purposes should just the
<code>stan</code> code be output with not fitting done.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters passed to <code><a href='https://rdrr.io/pkg/brms/man/brm.html'>brms::brm</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A "brmsfit" object or stan code (if <code>dry = TRUE</code>).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sam Abbott</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'># define some example data</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-datatable.com'>data.table</a></span><span class='op'>)</span>
<span class='va'>dt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/data.table.html'>data.table</a></span><span class='op'>(</span>
   region <span class='op'>=</span> <span class='st'>"France"</span>, cases <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>500</span>, by <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,
   date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2020-10-01"</span><span class='op'>)</span>, by <span class='op'>=</span> <span class='st'>"days"</span>, length.out <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>
   <span class='op'>)</span>
<span class='va'>dt</span><span class='op'>[</span>, <span class='va'>deaths</span> <span class='op'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/shift.html'>shift</a></span><span class='op'>(</span><span class='va'>cases</span>, <span class='fl'>5</span><span class='op'>)</span> <span class='op'>*</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>]</span>
</div><div class='co'>#&gt;     region cases       date deaths
#&gt;  1: France    10 2020-10-01     NA
#&gt;  2: France    20 2020-10-02     NA
#&gt;  3: France    30 2020-10-03     NA
#&gt;  4: France    40 2020-10-04     NA
#&gt;  5: France    50 2020-10-05     NA
#&gt;  6: France    60 2020-10-06      1
#&gt;  7: France    70 2020-10-07      2
#&gt;  8: France    80 2020-10-08      3
#&gt;  9: France    90 2020-10-09      4
#&gt; 10: France   100 2020-10-10      5
#&gt; 11: France   110 2020-10-11      6
#&gt; 12: France   120 2020-10-12      7
#&gt; 13: France   130 2020-10-13      8
#&gt; 14: France   140 2020-10-14      9
#&gt; 15: France   150 2020-10-15     10
#&gt; 16: France   160 2020-10-16     11
#&gt; 17: France   170 2020-10-17     12
#&gt; 18: France   180 2020-10-18     13
#&gt; 19: France   190 2020-10-19     14
#&gt; 20: France   200 2020-10-20     15
#&gt; 21: France   210 2020-10-21     16
#&gt; 22: France   220 2020-10-22     17
#&gt; 23: France   230 2020-10-23     18
#&gt; 24: France   240 2020-10-24     19
#&gt; 25: France   250 2020-10-25     20
#&gt; 26: France   260 2020-10-26     21
#&gt; 27: France   270 2020-10-27     22
#&gt; 28: France   280 2020-10-28     23
#&gt; 29: France   290 2020-10-29     24
#&gt; 30: France   300 2020-10-30     25
#&gt; 31: France   310 2020-10-31     26
#&gt; 32: France   320 2020-11-01     27
#&gt; 33: France   330 2020-11-02     28
#&gt; 34: France   340 2020-11-03     29
#&gt; 35: France   350 2020-11-04     30
#&gt; 36: France   360 2020-11-05     31
#&gt; 37: France   370 2020-11-06     32
#&gt; 38: France   380 2020-11-07     33
#&gt; 39: France   390 2020-11-08     34
#&gt; 40: France   400 2020-11-09     35
#&gt; 41: France   410 2020-11-10     36
#&gt; 42: France   420 2020-11-11     37
#&gt; 43: France   430 2020-11-12     38
#&gt; 44: France   440 2020-11-13     39
#&gt; 45: France   450 2020-11-14     40
#&gt; 46: France   460 2020-11-15     41
#&gt; 47: France   470 2020-11-16     42
#&gt; 48: France   480 2020-11-17     43
#&gt; 49: France   490 2020-11-18     44
#&gt; 50: France   500 2020-11-19     45
#&gt;     region cases       date deaths</div><div class='input'><span class='va'>dt</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>deaths</span><span class='op'>)</span>, <span class='va'>deaths</span> <span class='op'>:=</span> <span class='fl'>0</span><span class='op'>]</span>
</div><div class='co'>#&gt;     region cases       date deaths
#&gt;  1: France    10 2020-10-01      0
#&gt;  2: France    20 2020-10-02      0
#&gt;  3: France    30 2020-10-03      0
#&gt;  4: France    40 2020-10-04      0
#&gt;  5: France    50 2020-10-05      0
#&gt;  6: France    60 2020-10-06      1
#&gt;  7: France    70 2020-10-07      2
#&gt;  8: France    80 2020-10-08      3
#&gt;  9: France    90 2020-10-09      4
#&gt; 10: France   100 2020-10-10      5
#&gt; 11: France   110 2020-10-11      6
#&gt; 12: France   120 2020-10-12      7
#&gt; 13: France   130 2020-10-13      8
#&gt; 14: France   140 2020-10-14      9
#&gt; 15: France   150 2020-10-15     10
#&gt; 16: France   160 2020-10-16     11
#&gt; 17: France   170 2020-10-17     12
#&gt; 18: France   180 2020-10-18     13
#&gt; 19: France   190 2020-10-19     14
#&gt; 20: France   200 2020-10-20     15
#&gt; 21: France   210 2020-10-21     16
#&gt; 22: France   220 2020-10-22     17
#&gt; 23: France   230 2020-10-23     18
#&gt; 24: France   240 2020-10-24     19
#&gt; 25: France   250 2020-10-25     20
#&gt; 26: France   260 2020-10-26     21
#&gt; 27: France   270 2020-10-27     22
#&gt; 28: France   280 2020-10-28     23
#&gt; 29: France   290 2020-10-29     24
#&gt; 30: France   300 2020-10-30     25
#&gt; 31: France   310 2020-10-31     26
#&gt; 32: France   320 2020-11-01     27
#&gt; 33: France   330 2020-11-02     28
#&gt; 34: France   340 2020-11-03     29
#&gt; 35: France   350 2020-11-04     30
#&gt; 36: France   360 2020-11-05     31
#&gt; 37: France   370 2020-11-06     32
#&gt; 38: France   380 2020-11-07     33
#&gt; 39: France   390 2020-11-08     34
#&gt; 40: France   400 2020-11-09     35
#&gt; 41: France   410 2020-11-10     36
#&gt; 42: France   420 2020-11-11     37
#&gt; 43: France   430 2020-11-12     38
#&gt; 44: France   440 2020-11-13     39
#&gt; 45: France   450 2020-11-14     40
#&gt; 46: France   460 2020-11-15     41
#&gt; 47: France   470 2020-11-16     42
#&gt; 48: France   480 2020-11-17     43
#&gt; 49: France   490 2020-11-18     44
#&gt; 50: France   500 2020-11-19     45
#&gt;     region cases       date deaths</div><div class='input'>
<span class='va'>dt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='prepare.html'>prepare</a></span><span class='op'>(</span>
  <span class='va'>dt</span>, model <span class='op'>=</span> <span class='st'>"convolution"</span>, location <span class='op'>=</span> <span class='st'>"region"</span>,
  primary <span class='op'>=</span> <span class='st'>"cases"</span>, secondary <span class='op'>=</span> <span class='st'>"deaths"</span>,
  <span class='op'>)</span>

<span class='co'># fit the convolution model using a Poisson observation model</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='brmid.html'>idbrm</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>dt</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span>identity <span class='op'>=</span> <span class='st'>"link"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='co'>#&gt; <span class='error'>Error in poisson(identity = "link"): </span>unused argument (identity = "link")</div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Sam Abbott, Sebastian Funk.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


